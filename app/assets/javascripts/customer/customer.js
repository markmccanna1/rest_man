var FloorPlan = {
  init: function(){
    this.draw = SVG('floorplan').size('100%','100%')
    this.tables = new Array()
  }
}

var Table = {
  init: function(id){
    this.table = FloorPlan.draw.circle(100,100).attr({fill: 'white', class: 'table', id: 'table' + id})
    this.table.stroke({color: 'black', width: 2})
    this.table.draggable()
    this.table.center('5%', '35%')
    this.table.click(this.addClickEvent)

    FloorPlan.tables.push(this)

    this.chairs = new Array()
    return this
  },

  addClickEvent: function(){
    elementId = this.attr('id')
    table = Table.getTableById(elementId)
    console.log(elementId)

    var idPat = /\d/

    var dataTag = idPat.exec(elementId)[0]

    console.log(dataTag[0])

    var form = '<form action="/stream" method="post" id="check_in"> <input type="submit" value="Check In"> <input type="hidden" value="'+ elementId + '" name=example> </form>'

  $('#header').append(form)
    table.table.fill('black')
    Table.table.click(null)
  },

  getTableById: function(id){
    table = FloorPlan.tables.filter(function(element) {return element.table.attr('id') === id
    })
    return table[0]
  }
}

$('document').ready(function() {
   if ($('body.customer_profiles').length) {
    console.log("Page generated by the customer controller.");
  }
  if($('#floorplan').length){
    FloorPlan.init()
    Table.init(1)
  }
});
